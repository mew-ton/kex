---
trigger: always_on
---
# Documentation Rules (Ref: Kex)

This project uses [Kex](https://github.com/mew-ton/kex) for knowledge management. Before modifying code or Kex-managed documentation, please follow these rules.

**GUIDELINE RETRIEVAL:**
Your context already contains high-priority guidelines (Skills) based on project keywords.

**When to use Kex MCP (`search_documents`):**
1.  **Missing Context**: If the current task involves a domain not covered by the loaded Skills.
    *   *Action*: Search to find relevant guidelines.
    *   *Follow-up*: If these guidelines are permanently relevant, **propose adding new keywords** to `.kex.yaml` and running `kex update`.
2.  **Deep Dive**: If the Skill summary is insufficient and you need more specific implementation details.
3.  **Verification**: To verify if a new pattern is compliant when in doubt.

**The "Search Signal" Protocol:**
1.  **CHECK**: Review loaded Skills first.
2.  **SEARCH**: If strictly necessary, execute `search_documents`.
    *   **Scope Strategy**: Construct the scope hierarchy: `Domain` / `Platform` (Optional) / `Technology` (Optional).
        *   **Rule**: You **MUST** include the `Domain` (e.g., `kex`, `api`).
        *   **Manual Construction (Primary)**:
            *   `["kex", "documentation"]` (Domain + Tech)
            *   `["api", "documentation"]` (Domain + Tech)
        *   **File Inference (Helper)**: `filePath` automatically infers scopes, but is secondary to understanding the correct domain.
            *   `filePath: "docs/api.md"` infers `["api", "documentation"]`.
    *   **Keyword Strategy**: Combine keywords from these 3 dimensions:
        *   **Object**: Target entity (e.g., "frontmatter", "filename")
        *   **Symptom**: Context/Problem (e.g., "missing", "invalid")
        *   **Concept**: Quality/Goal (e.g., "consistency", "style")

    > [!TIP]
    > **Scope Cheatsheet (Documentation Context)**
    > *   **Domain**: `kex`, `api`, `cli`, `sdk` (Target Product/Area)
    > *   **Platform**: `user-guide`, `reference`, `architecture`
    > *   **Technology**: `markdown`, `mermaid`, `godoc`
    >
    > **Construct the scope**: `[Domain, Platform, Technology]`
3.  **VERIFY**: Use the retrieved knowledge to supplement your context.

## Adding New Knowledge

1.  **Search existing structure** to understand where new files belong.
2.  **Check for conflicts** using `Glob`.
3.  **Create Markdown files** with valid Frontmatter (id, title, description, keywords).
4.  **Run `kex check`** to validate.



## General Usage Note

**Note**: Use `Glob`/`read_file_content` (or equivalent file system tools) only for existence checks, not for content search. Always rely on the indexed knowledge base via `search_documents`.
