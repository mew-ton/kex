# 機能 (Features)

Kex は **キーワード (Keywords)** と **スコープ (Scopes)** を組み合わせることで、強力なコンテキスト検索機能を提供します。

## キーワード (Keywords)

キーワードは、マークダウン・ドキュメントの Frontmatter で定義される明示的なメタデータです。これらは Kex における検索の要となります。

### 仕組み

1.  **定義**: ドキュメントの Frontmatter にある (`keywords`) フィールドに関連するタグを追加します。
2.  **インデックス**: Kex はキーワードからドキュメントへの逆引きインデックスを構築します。
3.  **検索**: AI エージェント (またはユーザー) が用語を検索すると、Kex はこれらのキーワードに対してマッチングを行います。

### 例

```yaml
---
id: "BUTTON_COMPONENT"
title: "Button Component"
keywords: ["ui", "component", "button", "frontend", "design-system"]
---
```

> **ヒント (Vibe Coding)**: 「react」や「typescript」のような技術用語と、「auth」や「payment」のような概念的な用語を混ぜてキーワードに設定することで、様々なコンテキストでドキュメントが見つかりやすくなります。

## スコープ (Scopes)

スコープは、ディレクトリ構造から自動的に導出される暗黙的なコンテキストマーカーです。現在の作業コンテキストに基づいて検索結果を **絞り込む** ために使用されます。

### 仕組み

1.  **ディレクトリ構造**: `contents/` ディレクトリを論理的に整理します。
2.  **導出**: Kex はパスに含まれるすべてのディレクトリ名を「スコープ」として扱います。
3.  **フィルタリング**: 検索時にスコープが指定された場合 (例: ユーザーが現在編集しているファイルから導出される)、Kex は少なくとも1つのスコープを共有するドキュメントのみを検索結果として返します。

### 例

`contents/frontend/components/Button.md` にあるファイルの場合:

- **パス**: `contents/frontend/components/Button.md`
- **導出されるスコープ**: `["frontend", "components"]`

もしユーザーが `src/frontend/login.tsx` (これは `frontend` スコープを持つと見なされます) を編集している際に検索を行うと、Kex は `frontend` スコープを持つドキュメントを優先して検索します。

### スコープの包含関係 (Subset Filtering)

検索結果は **スコープの包含関係 (Subset)** によって厳密にフィルタリングされます。以下の条件を満たすドキュメントのみがヒットします:
- **キーワード** がマッチする。
- かつ、**ドキュメントが持つすべてのスコープ** が、検索クエリのコンテキスト (または指定スコープ) に含まれていること。

例えば、`contents/frontend/components/Button.md` (スコープ: `[frontend, components]`) は、`frontend` だけのコンテキストではヒットしません。`frontend` かつ `components` のコンテキストが必要です。これは、特定のサブコンテキストに属するドキュメントが、より広いコンテキストでの検索結果を汚染しないようにするためです。
